# 1.5协议层次及其服务模型

### 1.5.1 分层的体系结构

1. 协议分层

   > 为了给网络协议的设计提供一个结构，网络设计者以**分层**的方式组织协议以及实现这些协议的网络硬件和软件。
   >
   > 我们再次关注某层向它的上一层提供的服务，即所谓的**服务模型**。
   >
   > 各层所有协议被称为**协议栈**
   >
   > 因特网的协议由5个层次组成：物理层、链路层、网络层、运输层和应用层

   - 应用层

     > 1. 应用层是网络应用程序以及它们的应用层协议存留的地方。
     >
     > 2. 因特网的应用层协议包括许多协议，例如HTTP、SMTP、FTP。
     > 3. 应用层协议分布在多个端系统上，而一个端系统中的应用程序使用协议与另一个端系统中的应用程序交换信息分组。我们把这种位于应用层的信息分组称为**报文**。

   - 运输层

     > 1. 因特网的运输层在应用程序端点之间传送应用层报文。在因特网中，有两种运输协议：**TCP**和**UDP**。利用任何一个都能运输应用层报文。
     > 2. TCP
     >    - TCP向它的应用程序提供了**面向连接**的服务。这种服务包括了应用层报文向目的地**确保传递**和**流量控制**。
     >    - TCP也将长报文划分为短报文，并提供拥塞控制机制。因此网络拥塞时，源抑制其传输速率。
     > 3. UDP
     >    - UDP向它的应用程序提供**无连接服务**。这是一种**不提供不必要服务**的服务。
     >    - 没有可靠性，没有流量控制，也没有拥塞控制。
     > 4. 我们把运输层的分组称为报文段。

   - 网络层

     > 1. 因特网的网络层负责将称为**数据报**的**网络层分组**从一台主机移动到另一台主机。
     > 2. 因特网的网络层包括网际协议IP，该协议定义了在数据报中的各个字段以及端系统和路由器如何作用于这些字段。IP仅有一个，所有具有网络层的因特网组件必须运行IP。
     > 3. 网络层也包括*许多*决定路由的**路由选择协议**，它根据该路由将数据报从源传输到目的地。
     > 4. 我们也简单的称网络层为IP层。

   - 链路层

     > 1. 网络层将数据报下传给链路层，链路层沿着路径将数据报传递给下一个节点。在下一个节点，链路层将数据报上传给网络层
     > 2. 由链路层提供的服务取决于应用于该链路的**特定链路层协议**。
     > 3. 某些协议**基于链路**提供**可靠传递**，值得注意的是，这种可靠的传递服务不同于TCP的可靠传递服务。（具体是什么不同？）
     > 4. 因为数据报从源到目的地传送通常需要经过几条链路，一个数据报可能被沿途不同链路上的不同链路层协议处理
     > 5. 我们把链路层分组称为**帧**
     
   - 物理层

     > 1. 物理层的任务是将帧中的一个个比特从一个节点移动到下一个节点。
     > 2. 这层的协议仍然和链路相关，并进一步与该链路的实际传输媒体相关。

2. OSI模型

   > 1. OSI模型有七层，分别是：应用层、表示层、会话层、运输层、网络层、数据链路层、物理层。



****

### 1.5.2 封装

1. 封装

   > 1. 在发送主机端，一个**应用层报文**被传送到运输层。
   > 2. 在最简单情况下，运输层收到报文并附上附加信息（即运输层首部信息。）该首部将被接收端的运输层使用。应用层报文和运输层首部信息一同构成**运输层报文段**。即运输层报文段封装了应用层报文。附加的信息可能有:
   >    - 允许接收端运输层向上适当的应用程序交付报文的信息
   >    - 差错检测位信息，该信息让接收方能够判断报文中的比特是否在途中已被改变。
   >    - 等待
   > 3. 运输层则向网络层传递该报文段，网络层增加了如**源和目的端系统地址**等网络层首部信息。生成**网络层数据报**。
   > 4. 该数据报接下来被传递给链路层，链路层增加了他自己的链路层首部信息并生成**链路层帧**。
   > 5. 所以我们看到，在每一个层，一个分组具有两种类型的字段：**首部字段**和**有效载荷字段**（通常是来自上一层的分组）

